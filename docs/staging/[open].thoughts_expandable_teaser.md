# Thoughts 列表展开交互 - 产品需求文档（PRD）

## 1. 项目概述
- 当前 Thoughts 卡片在首页、标签页、相关文章推荐等列表位置仅展示三行内容，超出部分没有直接的延伸阅读入口，读者必须跳转详情页。
- 本次迭代希望引入可展开/收起的交互，让读者在列表位置快速阅读全文，同时保留卡片紧凑布局与现有标签区域。

## 2. 目标与成功指标
- 提升 Thoughts 卡片的可读性，增加列表位置的完读率。
- 控制页面信息密度，保障卡片展开后依然整洁有序。
- 次级指标：读者在展开后点击详情页按钮的转化率、展开与收起操作的完成率。

## 3. 范围界定
### 3.1 In Scope
- 首页混合流中的 Thoughts 卡片。
- 标签页、归档页、相关文章推荐区域里出现的 Thoughts 卡片。
- 桌面端与移动端的视觉与交互统一实现。

### 3.2 Out of Scope
- Blog（文章）卡片的展示逻辑与样式。
- Thoughts 详情页本身的内容结构与评论功能。

## 4. 体验设计
### 4.1 默认预览态
- 文本通过 CSS 限制在三行展示，样式与当前实现一致。
- 若正文不足三行，保持原样，无额外交互控件。
- 卡片右下角的标签、发布日期等元素位置不变。

### 4.2 展开态
- 当正文被截断时，在第三行末尾追加 `展开想法` 交互。
- 点击后卡片在原位置展开，展示完整 Markdown 内容（不含评论）。
- Thoughts 中的图片、音频、视频等多媒体元素在展开状态下原样呈现，以促使作者主动控制篇幅。
- 展开后交互文案切换为 `收起`，再次点击恢复三行摘要。
- 展开/收起时保持卡片宽度不变，避免影响周围布局；滚动位置尽量保持卡片顶端在视口内。

### 4.3 收起态
- `收起` 点击后恢复三行限制，同时隐藏 `进入详情页` 按钮，仅保留原卡片的跳转方式。
- 若用户在展开态操作多媒体（如播放音频），收起时需要明确定义状态（默认直接停止播放）。

### 4.4 详情页入口
- 展开态下，在正文底部与标签区域之间新增按钮样式的 `进入详情页` 入口。
- 按钮点击后按照现有逻辑跳转到该 Thought 的详情页。

## 5. 交互细节
- 展开/收起动画时长不超过 200ms，过渡曲线建议使用 ease-in-out。
- `展开想法`、`收起`、`进入详情页` 均需支持键盘 Tab 聚焦与 Enter/Space 触发。
- 当键盘用户展开内容时，应确保焦点留在触发控件上，避免焦点意外跳转。
- 若页面加载时卡片已在展开状态（未来可能的深链场景），需要正确渲染按钮与标签位置。

## 6. 视觉与排版要求
- `展开想法`/`收起` 的文案样式需与正文区分（颜色或下划线），但保持同一行内展示；若存在省略号，置于控件前。
- `进入详情页` 采用按钮视觉，建议使用次级按钮（副按钮）样式，以免与主要 CTA 冲突。
- 展开后卡片右下角标签区域仍固定在卡片底部；必要时为标签区域设置定位或撑开容器高度，避免被正文或按钮覆盖。
- 多媒体的最大宽度与卡片宽度一致，超出需自动缩放；高度可按原比例显示，可选懒加载或占位图以优化性能。

## 7. 内容与多媒体策略
- Thoughts 作者可继续使用 Markdown 插入图片、音频、视频；列表中默认不屏蔽多媒体。
- 推荐对图片启用懒加载，对音视频提供静态封面或播放控件，防止首屏阻塞。
- 若多媒体加载失败，需保留占位符并可点击进入详情页查看完整内容。

## 8. 技术实现要点
- 若使用 CSS `line-clamp` 控制行数，需在前端判断文本是否溢出以显示/隐藏 `展开全部`。
- 为每个卡片维护本地展开状态（如 `is-expanded`），在 Hugo 生成的静态页面上通过 JS 管理交互。
- 确保无 JS 场景下依然可进入详情页（例如正文区域保持默认跳转行为）。
- 多媒体在展开后加载，可结合 IntersectionObserver 实现懒加载。
- 需要验证与现有列表虚拟化或分页逻辑的兼容性（如有）。

## 9. 可访问性要求
- 交互控件需使用语义化元素（例如 `<button>`），并提供 ARIA 标签（如 `aria-expanded`）。
- 动画应尊重 `prefers-reduced-motion` 设置，必要时提供无动画降级。
- 确保按钮与文本的颜色对比度符合 WCAG AA 标准。

## 10. 验收标准
- 溢出的 Thoughts 卡片展示 `展开全部`；点击后全文展开并显示按钮样式的 `进入详情页`，再点击 `收起` 恢复三行。
- 不溢出的 Thoughts 卡片无额外控件，交互与当前一致。
- 展开态下多媒体内容完整可见，标签区域始终位于卡片右下角。
- 交互在桌面端与移动端均正常，键盘可操作，动画流畅。

## 11. 未决事项
1. 多媒体的懒加载方案与占位样式需要与前端开发确认，实现成本与性能收益的平衡。
2. 展开态播放音视频后收起时是否强制停止播放，需产品/体验确认。
3. `进入详情页` 按钮的具体层级与尺寸（如是否需要全宽按钮）待视觉设计稿确认。
