/* ========================================
   全站字体设置 - 参考 UNTAG 设计
   ======================================== */

/* 全局字体设置 */
body,
html {
    font-family: "Noto Serif SC", "Noto Serif", "Noto Serif CJK SC", "Noto Serif CJK", 
                 "Source Han Serif SC", "source-han-serif-sc", 
                 "Times New Roman", "Georgia", serif;
    font-weight: 500;
    letter-spacing: 0.03em;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    color: var(--content);  /* 使用主题的内容颜色变量,确保颜色足够深 */
}

/* 标题字体增强 */
h1, h2, h3, h4, h5, h6,
.post-title,
.entry-header h2 {
    font-family: "Noto Serif SC", "Noto Serif", "Noto Serif CJK SC", "Noto Serif CJK", 
                 "Source Han Serif SC", "source-han-serif-sc", 
                 "Times New Roman", "Georgia", serif;
    font-weight: 700;
    letter-spacing: 0.02em;
    text-rendering: optimizeLegibility;
}

/* 正文字体 */
.post-content,
.entry-content,
article {
    font-family: "Noto Serif SC", "Noto Serif", "Noto Serif CJK SC", "Noto Serif CJK", 
                 "Source Han Serif SC", "source-han-serif-sc", 
                 "Times New Roman", "Georgia", serif;
    font-weight: 500;
    letter-spacing: 0.03em;
    color: var(--content);  /* 确保正文颜色足够深 */
}

/* 卡片描述文字增强颜色 */
.post-entry .entry-content,
.thought-entry .entry-content {
    color: var(--content);  /* 使用主内容颜色而不是次要颜色 */
}

.post-entry .entry-content p,
.thought-entry .entry-content p {
    color: var(--content);
}

/* 代码字体保持等宽 */
code,
pre,
kbd,
samp,
tt,
var {
    font-family: -apple-system, BlinkMacSystemFont, "Menlo", "Monaco", "Consolas", 
                 "Courier New", monospace;
    font-weight: 400;
    letter-spacing: 0;
}

.post-header .post-title {
    font-size: 24px !important;  /* 与首页博客列表标题大小一致 */
    margin-bottom: 2px;
}

@media screen and (max-width: 768px) {
    .post-content {
        font-size: 16px !important;  /* 移动端增大字体 */
    }
}

/* 优化博客文章详情页布局间距 */

/* 调整文章头部整体间距 */
.post-header {
    margin-bottom: 3rem;
}

/* 调整面包屑导航的间距 */
.nav.breadcrumbs {
    margin-bottom: 2rem;
}

/* 调整文章标题的间距 */
.post-title {
    margin: 1rem 0 1.5rem 0;
    line-height: 1.4;
}

/* 调整文章元信息（时间等）的间距和样式 */
.post-meta {
    margin-top: 1rem;
}

/* 确保移动端也有良好的间距 */
@media screen and (max-width: 768px) {
    .post-header {
        margin-bottom: 2rem;
    }
    
    .nav.breadcrumbs {
        margin-bottom: 1.5rem;
    }
    
    .post-title {
        margin: 0.8rem 0 1.2rem 0;
    }
    
    .post-meta {
        margin-top: 0.8rem;
    }
}

/* 统一所有页面的标题大小 - 参考 UNTAG 设计 */
.post-content h1,
.main .post-content h1 {
    margin: 40px auto 32px;
    font-size: 2.2em;  /* 与 UNTAG 一致 */
    line-height: 1.4;
}

.post-content h2,
.main .post-content h2 {
    margin: 1.5em auto 0.75em;  /* 与 UNTAG 一致 */
    font-size: 1.5em;
    line-height: 2em;
}

.post-content h3,
.main .post-content h3 {
    margin: 1.25em auto 0.625em;
    font-size: 1.25em;
    line-height: 2em;
}

.post-content h4,
.main .post-content h4 {
    margin: 1em 0;
    font-size: 1.125em;
}

.post-content h5,
.main .post-content h5 {
    margin: 1em 0;
    font-size: 1.125em;
}

.post-content h6,
.main .post-content h6 {
    margin: 1em 0;
    font-size: 1.125em;
}

/* 统一所有页面的正文字体大小 */
.post-content,
.post-content p {
    font-size: 16px;
    line-height: 2em;  /* 参考 UNTAG 的行高设计,提升阅读舒适度 */
}

/* 段落间距 */
.post-content p {
    margin: 1em 0;
}

@media screen and (max-width: 768px) {
    .post-content,
    .post-content p {
        font-size: 18px !important;  /* 移动端增大字体 */
        line-height: 1.7;  /* 适当调整行高以提升移动端阅读体验 */
    }
}

/* 目录样式优化 */
.toc {
    margin: 0 2px 40px 2px;
    padding: 0.8rem 1.2rem;  /* 减小上下内边距 */
    border: 1px solid var(--border);
    background: var(--code-bg);
    border-radius: var(--radius);
    font-size: 0.9rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* 暗色模式下的目录样式 */
.dark .toc {
    background: var(--entry);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
}

/* 目录标题样式 */
.toc details summary {
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--secondary);
    margin-bottom: 0;
    padding: 0;
    border-bottom: none;
}

/* 移除之前错误的样式 */
.toc details summary::before {
    display: none;
}

/* 调整展开/折叠符号与文字的间距 */
.toc details summary::-webkit-details-marker {
    margin-right: 1em;  /* 增加间距 */
}

.toc details summary::marker {
    margin-right: 1em;  /* 增加间距 */
}

/* 目录内容样式 */
.toc .inner {
    margin: 0.8rem 0.8rem 0;
    padding: 0 0.4rem;
    font-size: 0.8rem;
}

/* 目录链接样式 */
.toc a {
    color: var(--secondary);
    transition: color 0.2s;
    text-decoration: none;
    line-height: 1.7;
}

.toc a:hover {
    color: var(--primary);
    box-shadow: none;
}

/* 二级目录缩进 */
.toc li ul {
    margin-left: 0.8rem;
    margin-top: 0.2rem;
    margin-bottom: 0.4rem;
}

/* 目录项间距 */
.toc li {
    margin: 0.4rem 0;
    color: var(--secondary);
}

/* Bookmark 样式 */
.bookmark-container {
  margin: 1rem 0;
  border: 1px solid var(--border);
  border-radius: 8px;
  overflow: hidden;
  transition: all 0.3s ease;
}

.bookmark-container:hover {
  border-color: var(--primary);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.bookmark-link {
  display: flex;
  align-items: center;
  padding: 1rem;
  color: var(--primary);
  text-decoration: none;
  background: var(--entry);
}

.bookmark-content {
  flex: 1;
  margin-right: 1rem;
  overflow: hidden;
}

.bookmark-title {
  font-size: 1rem;
  font-weight: 500;
  margin-bottom: 0.25rem;
  color: var(--primary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.bookmark-url {
  font-size: 0.875rem;
  color: var(--secondary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.bookmark-icon {
  flex-shrink: 0;
  color: var(--secondary);
}

.bookmark-icon svg {
  display: block;
}

/* 深色模式适配 */
.dark .bookmark-container {
  border-color: var(--border);
}

.dark .bookmark-container:hover {
  border-color: var(--primary);
}

.dark .bookmark-link {
  background: var(--entry);
}

.dark .bookmark-title {
  color: var(--primary);
}

.dark .bookmark-url {
  color: var(--secondary);
}

/* 添加 Bookmark 摘要样式 */
.bookmark-description {
  font-size: 0.85em; /* 字体缩小到大约85% */
  color: #555;     /* 深灰色文字 */
  margin-top: 4px;  /* 和标题之间增加一点上边距 */
  margin-bottom: 4px; /* 和URL之间增加一点下边距 */
  /* 为了防止过长的摘要撑破布局，可以添加以下样式 */
  white-space: normal; /* 允许换行 */
  word-break: break-word; /* 允许在单词内换行 */
  display: -webkit-box;
  -webkit-line-clamp: 2; /* 最多显示2行 */
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* 深色模式下的摘要样式 */
.dark .bookmark-description {
  color: #aaa; /* 浅灰色，适应深色背景 */
}

.thought-entry.expanded .bookmark-container {
  transition: none;
  cursor: pointer;
}

.thought-entry.expanded .bookmark-container:hover {
  border-color: var(--border);
  box-shadow: none;
}

.thought-entry.expanded .bookmark-link {
  cursor: pointer;
}

/* 通用上一条下一条导航 */
.content-nav {
  display: flex;
  align-items: stretch;
  gap: 1rem;
  margin: 2.2rem 0 1.8rem;
  flex-wrap: wrap;
}

.content-nav-link {
  flex: 1 1 260px;
  min-width: 0;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 0.35rem;
  padding: 0.9rem 1.1rem;
  border: 1px solid var(--border);
  border-radius: 10px;
  background-color: var(--entry);
  text-decoration: none;
  transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
}

.content-nav-link:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08);
  border-color: var(--primary);
}

.content-nav-label {
  font-size: 0.82rem;
  color: var(--secondary);
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
}

.content-nav-title {
  font-size: 1.05rem;
  font-weight: 600;
  color: var(--primary);
  word-break: break-word;
}

.content-nav-link.next {
  margin-left: auto;
  align-items: flex-end;
  text-align: right;
}

.content-nav.sky-eye-nav {
  margin: 1.6rem 0 1.2rem;
}

.content-nav.post-nav {
  margin-top: 2.6rem;
}

/* Sky Eye cards on the homepage show three lines of description */
.post-entry .sky-eye-entry-content-wrapper .entry-content {
  -webkit-line-clamp: 3;
  line-clamp: 3;
}

.sky-eye-home-card-title-link {
  display: inline;
  color: inherit;
  text-decoration: none;
}

.sky-eye-home-card-title-icon {
  display: inline-block;
  height: 1em;
  width: auto;
  margin-left: 0.08em;
  vertical-align: -0.12em;
}

@media screen and (max-width: 767px) {
  .content-nav {
    flex-direction: column;
    gap: 0.65rem;
    margin: 1.4rem 0 1.1rem;
  }

  .content-nav-link,
  .content-nav-link.next {
    margin-left: 0;
    align-items: flex-start;
    text-align: left;
    padding: 0.8rem 1rem;
    gap: 0.3rem;
    flex: none;
    width: 100%;
  }

  .content-nav-label {
    font-size: 0.78rem;
  }

  .content-nav-title {
    font-size: 1.02rem;
  }
}

@media screen and (max-width: 640px) {
  .post-entry .entry-header h2 {
    font-size: 18px;
    line-height: 1.4;
  }

  .post-entry .sky-eye-entry-content-wrapper .entry-header .sky-eye-home-card-title {
    font-size: 18px;
  }
}

/* 引用博文部分样式 */
.post-references {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border);
}

.post-references h2 {
    font-size: 1.2rem;
    margin-bottom: 1rem;
    color: var(--primary);
}

.post-references h2 .reference-count {
    display: inline-block;
    font-size: 0.9em;
    color: var(--secondary);
    margin-left: 0.5rem;
}

/* 只设置列表容器的间距 */
.post-references .post-references-list {
    display: flex;
    flex-direction: column;
    gap: 0.3rem;
}

/* 移动端适配 */
@media screen and (max-width: 768px) {
    .post-references {
        margin-top: 1.5rem;
        padding-top: 1rem;
    }

    .post-references h2 {
        font-size: 1.1rem;
        margin-bottom: 0.8rem;
    }

    .post-references .post-references-list {
        gap: 0.2rem;
    }
}

/* 网站 favicon 样式 */
.site-favicon {
    display: inline-block;
    margin-left: 10px; /* 增加与标题的间距 */
    vertical-align: middle; /* 垂直居中 */
    width: 18px; /* 调整尺寸 */
    height: 18px;
    object-fit: contain; /* 确保图标完整显示 */
    border-radius: 0 !important; /* 强制移除圆角 */
    -webkit-border-radius: 0 !important; /* Safari 兼容性 */
    -moz-border-radius: 0 !important; /* Firefox 兼容性 */
    overflow: visible !important; /* 确保图像不被裁剪 */
    box-shadow: none !important; /* 移除可能的阴影 */
    padding: 0 !important; /* 移除内边距 */
    background: transparent !important; /* 确保背景透明 */
    border: none !important; /* 移除边框 */
    transform: none !important; /* 防止变形 */
    filter: none !important; /* 移除滤镜效果 */
    clip-path: none !important; /* 移除裁剪路径 */
    mask: none !important; /* 移除蒙版 */
    position: relative; /* 使用相对定位 */
    top: -2px; /* 微调垂直位置，使其与文本更好地对齐 */
}

@media screen and (max-width: 768px) {
    .site-favicon {
        margin-left: 8px; /* 移动端稍微减小间距 */
        width: 18px; /* 增大移动端尺寸 */
        height: 18px; /* 增大移动端尺寸 */
        top: -1.5px; /* 微调垂直位置 */
    }
}

/* 普通博文和天空之眼卡片的悬浮效果 */
.post-entry:not(.thought-entry):hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
}

.dark .post-entry:not(.thought-entry):hover {
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
}

/* 首页随思录样式调整 */
.post-entry.thought-entry {
    position: relative;
    padding: 20px 16px;
    margin-bottom: 0;
    background: transparent;
    border: none;
    border-radius: 0;
    box-shadow: none;
    border-bottom: 1px solid var(--border);
    overflow: hidden;
    /* 移除所有过渡效果，避免悬浮时跳动 */
    isolation: isolate;  /* 创建新的层叠上下文,避免 z-index 冲突 */
}

.post-entry.thought-entry::after {
    content: "";
    position: absolute;
    inset: 0;
    background: transparent;
    transition: background 0.15s ease;
    pointer-events: none;
    z-index: -2;
}

.post-entry.thought-entry:hover::after,
.post-entry.thought-entry:focus-within::after {
    background: var(--border);
    background: color-mix(in srgb, var(--entry) 92%, var(--content) 8%);
}

/* 内容层在最上层，这样不会被背景遮盖 */
.post-entry.thought-entry > *:not(.entry-link) {
    position: relative;
    z-index: 1;
}

/* entry-link 在背景之上、内容之下 */
.post-entry.thought-entry > .entry-link {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    z-index: -1;
}

/* 所有文本内容不阻止点击事件，让 entry-link 可以被点击 */
.thought-entry .entry-content,
.thought-entry .entry-header,
.thought-entry .entry-footer {
    pointer-events: none;
    position: relative;
    z-index: 1;  /* 确保内容在正确的层级 */
}

/* 只有真正的交互元素允许点击事件 */
.thought-entry .expand-btn,
.thought-entry .detail-link-btn,
.thought-entry .entry-footer a,
.thought-entry .thought-tag,
.thought-entry .entry-content a {
    position: relative;
    z-index: 3;  /* 提高层级,确保可以点击 */
    pointer-events: auto;
}

.post-entry.thought-entry:active {
    transform: none;
}

/* 确保 Thoughts 卡片悬浮时不产生任何位移或跳动 */
.post-entry.thought-entry:hover {
    transform: none;
}

.post-entry:not(.thought-entry) + .post-entry.thought-entry {
    border-top: 1px solid var(--border);
    margin-top: 20px;
    padding-top: 20px;
}

.post-entry.thought-entry + .post-entry:not(.thought-entry) {
    margin-top: 20px;
}

.thought-entry .entry-content {
    display: block;
    overflow: visible;
    -webkit-box-orient: initial;
    -webkit-line-clamp: initial;
}

/* 首页第一个随思录条目特殊样式 */
.first-entry.thought-entry {
    margin-bottom: 30px;  /* 增加与下面内容的间距 */
}

/* 确保随思录图片在首页正确显示 */
.posts .thought-entry .entry-content img {
    max-width: 100%;
    height: auto;
    margin: 15px 0;
    border-radius: 6px;
}

/* 确保移动端适配 */
@media screen and (max-width: 768px) {
    .posts .thought-entry {
        margin-top: 15px;
    }
    
    .first-entry.thought-entry {
        margin-bottom: 25px;
    }
    
    .posts .thought-entry .entry-content img {
        margin: 10px 0;
    }
}

/* Thought Tag Styles */
.thought-entry .entry-footer {
    display: flex; /* Use flexbox for better alignment */
    justify-content: space-between; /* Push date to left and tags to right */
    align-items: center; /* Vertically align items if they have different heights */
    flex-wrap: wrap; /* Allow items to wrap on small screens if necessary */
}

.thought-tags-list {
    /* Remove float, flexbox will handle positioning */
    margin-left: auto; /* Push to the right if footer is flex container */
    text-align: right;
}

.thought-tags-list .thought-tag {
    display: inline-block;
    margin-left: 6px;
    padding: 3px 8px;
    font-size: 0.8em;
    color: var(--tag-color, var(--secondary)); /* Use theme tag color, fallback to secondary */
    background-color: var(--tag-bg, var(--code-bg)); /* Use theme tag background, fallback to code-bg */
    border: 1px solid var(--tag-border-color, var(--border)); /* Use theme tag border, fallback to general border */
    border-radius: var(--radius);
    text-decoration: none;
    white-space: nowrap; /* Prevent tags from breaking into multiple lines */
}

.thought-tags-list .thought-tag:hover {
    color: var(--tag-hover-color, var(--primary)); /* Use theme tag hover color, fallback to primary */
    background-color: var(--tag-hover-bg, var(--hover-bg)); /* Use theme tag hover background, fallback to hover-bg */
    border-color: var(--tag-hover-border-color, var(--primary)); /* Use theme tag hover border, fallback to primary */
}

/* Ensure the date meta-item doesn't take full width if footer is flex */
/* No specific style needed if justify-content: space-between is working well */ 

/* ========================================
   Thoughts 展开/收起功能样式
   ======================================== */

/* 预览态内容容器 */
.thought-entry .content-preview {
    position: relative;
}

/* 预览态内容样式 - 保持三行截断 */
.thought-entry .content-preview p {
    margin: 0.8em 0;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-bottom: 0.8em; /* 给展开按钮留出空间，同时与展开态保持一致 */
}

.thought-entry .content-preview p:first-child {
    margin-top: 0;
}

.thought-entry .content-preview p:last-child {
    margin-bottom: 0;
}

/* 展开按钮样式 */
.thought-entry .expand-btn {
    display: inline-block;
    color: var(--primary);
    text-decoration: underline;
    background: none;
    border: none;
    padding: 4px 0;
    margin: 0;
    font-size: inherit;
    font-family: inherit;
    cursor: pointer;
    position: relative;
    z-index: 3; /* 高于 entry-link 和内容 */
    transition: opacity 0.2s ease-in-out;
    margin-top: -0.4em; /* 使用负值让按钮更紧贴内容 */
    pointer-events: auto;  /* 确保可以点击 */
}

.thought-entry .expand-btn:hover {
    opacity: 0.7;
}

.thought-entry .expand-btn:focus {
    outline: 2px solid var(--primary);
    outline-offset: 2px;
}

/* 完整内容区域样式 */
.thought-entry .content-full {
    transition: opacity 0.2s ease-in-out;
}

/* 展开状态下的样式切换 */
.thought-entry.expanded .content-preview {
    display: none;
}

.thought-entry.expanded .content-full {
    display: block !important;
}

/* 展开态下禁用整卡链接 */
.thought-entry.expanded .entry-link {
    pointer-events: none;
    cursor: default;
}

.thought-entry.expanded .entry-content,
.thought-entry.expanded .entry-header,
.thought-entry.expanded .entry-footer {
    pointer-events: auto;
}

/* 操作按钮容器 */
.thought-entry .thought-actions {
    display: flex;
    gap: 12px;
    margin-top: 16px;
    padding-top: 12px;
    align-items: center;
}

/* 完整内容中的图片样式 */
.thought-entry .content-full img {
    max-width: 100%;
    height: auto;
    margin: 15px 0;
    border-radius: 6px;
}

/* 完整内容在展开态使用 thought-body 包裹，继承 post-content 样式 */
.thought-entry .thought-body.post-content {
    color: var(--content);
}

.thought-entry .thought-body.post-content > :first-child {
    margin-top: 0;
}

.thought-entry .thought-body.post-content > :last-child {
    margin-bottom: 0;
}

/* 响应 prefers-reduced-motion */
@media (prefers-reduced-motion: reduce) {
    .thought-entry .content-full,
    .thought-entry .expand-btn,
    .thought-entry .detail-link-btn {
        transition: none;
    }
}

/* 移动端适配 */
@media screen and (max-width: 768px) {
    .thought-entry .thought-actions {
        flex-direction: row;
        flex-wrap: wrap;
        gap: 8px;
        align-items: center;
        justify-content: flex-start;
    }
    
    .thought-entry .detail-link-btn {
        width: auto;
        text-align: left;
    }
    
    .thought-entry .expand-btn,
    .thought-entry .detail-link-btn {
        font-size: 16px; /* 避免移动端点击时触发自动放大 */
    }
    
    .thought-entry .thought-body.post-content,
    .thought-entry .thought-body.post-content p {
        font-size: 16px;
        line-height: 1.7;
    }
}

/* 降级方案 - 无 JavaScript 环境 */
.no-js .thought-entry .expand-btn {
    display: none;
}

/* 列表项行高 */
.post-content li {
    line-height: 2em;
}

.post-content li > p {
    line-height: 2em;
    margin: 0;
}

/* 引用块样式优化 */
.post-content blockquote {
    line-height: 2em;
    margin: 0 0 1.5em;
}

.post-content blockquote > p {
    margin: 0.5em 0;
}

/* 取消链接与后续中文字符之间的自动空格 */
.post-content a {
    margin-right: 0 !important;
}
